<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AI-Driven Train Control - OpenRailwayMap Exporter: A Rust-based Railway Data Retrieval and Visualization Tool</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="chapter_2.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="chapter_3.html"><strong aria-hidden="true">3.</strong> Web App</a></li><li class="chapter-item expanded "><a href="chapter_4.html"><strong aria-hidden="true">4.</strong> The Railway Graph Importer</a></li><li class="chapter-item expanded "><a href="chapter_5.html"><strong aria-hidden="true">5.</strong> Downloading Railway Graphs from OpenStreetMap</a></li><li class="chapter-item expanded "><a href="chapter_6.html"><strong aria-hidden="true">6.</strong> Python Bindings for OpenRailwayMap Exporter</a></li><li class="chapter-item expanded "><a href="chapter_7.html"><strong aria-hidden="true">7.</strong> Railway Model</a></li><li class="chapter-item expanded "><a href="chapter_8.html"><strong aria-hidden="true">8.</strong> The Railway Simulation</a></li><li class="chapter-item expanded "><a href="chapter_9.html" class="active"><strong aria-hidden="true">9.</strong> AI-Driven Train Control</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OpenRailwayMap Exporter: A Rust-based Railway Data Retrieval and Visualization Tool</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ai-driven-train-control"><a class="header" href="#ai-driven-train-control">AI-Driven Train Control</a></h1>
<p>In this chapter, we will discuss the use of artificial intelligence to control trains in a railway network simulation. The AI module developed in this project uses reinforcement learning (RL) to manage the train's actions, optimizing the train's movement through the network while ensuring safety and efficiency.</p>
<h2 id="81-reinforcement-learning"><a class="header" href="#81-reinforcement-learning">8.1 Reinforcement Learning</a></h2>
<p>Reinforcement learning is a type of machine learning where an agent learns to make decisions by interacting with its environment. The agent performs actions in the environment and receives feedback in the form of rewards or penalties. By exploring different actions and learning from the consequences, the agent gradually improves its decision-making abilities.</p>
<h2 id="82-trainagentai"><a class="header" href="#82-trainagentai">8.2 TrainAgentAI</a></h2>
<p>The <code>TrainAgentAI</code> struct represents a train agent controlled by a reinforcement learning algorithm. This struct contains several fields, including:</p>
<ul>
<li><code>railway_graph</code>: The railway graph representing the train network</li>
<li><code>current_node</code>: The current node the train is at</li>
<li><code>target_node</code>: The target node the train is heading to</li>
<li><code>agent_rl</code>: The reinforcement learning agent responsible for controlling the train</li>
<li><code>trainer</code>: The trainer responsible for training the reinforcement learning agent</li>
</ul>
<h2 id="83-training-the-ai-agent"><a class="header" href="#83-training-the-ai-agent">8.3 Training the AI Agent</a></h2>
<p>The <code>train</code> method of the <code>TrainAgentAI</code> struct is used to train the reinforcement learning agent for a specified number of iterations. During training, the agent explores different actions and updates its knowledge based on the rewards it receives. The agent uses Q-learning, a widely-used RL algorithm, to learn the best actions for each state.</p>
<h2 id="84-making-decisions"><a class="header" href="#84-making-decisions">8.4 Making Decisions</a></h2>
<p>Once the AI agent is trained, it can make decisions based on the current state of the train in the simulation. The <code>best_action</code> method returns the best action for the given state according to the trained reinforcement learning agent.</p>
<h2 id="85-observing-the-environment"><a class="header" href="#85-observing-the-environment">8.5 Observing the Environment</a></h2>
<p>The <code>observe</code> method allows the train agent to update its internal state based on the current position, target node, and other relevant information. This method ensures that the AI agent has the most up-to-date information about the environment when making decisions.</p>
<h2 id="86-implementing-the-decisionagent-trait"><a class="header" href="#86-implementing-the-decisionagent-trait">8.6 Implementing the DecisionAgent Trait</a></h2>
<p>By implementing the <code>DecisionAgent</code> trait for the <code>TrainAgentAI</code> struct, we enable the AI agent to interact with the simulation environment. The <code>next_action</code> and <code>observe</code> methods from the trait implementation allow the AI agent to make decisions and update its state based on the simulation environment.</p>
<h2 id="87-testing-the-ai-agent"><a class="header" href="#87-testing-the-ai-agent">8.7 Testing the AI Agent</a></h2>
<p>The test case in the <code>tests</code> module demonstrates how to create and train a <code>TrainAgentAI</code> instance. The test uses a sample railway graph and trains the AI agent for a specified number of iterations. After training, the agent can make decisions based on its current state, as shown by the <code>best_action</code> method.</p>
<p>In summary, this chapter has introduced an AI-driven approach to train control in a railway network simulation. Using reinforcement learning, the AI agent learns to make decisions that optimize train movement while maintaining safety and efficiency.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="chapter_8.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="chapter_8.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
